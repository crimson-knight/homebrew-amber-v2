# Amber Framework V2 CLI - Homebrew Tap

This is a private Homebrew tap for installing the Amber Framework V2 CLI tool.

## What is Amber V2?

Amber Framework V2 is a major update to the Amber web framework for Crystal that includes:

- **Grant ORM** - A new ActiveRecord-style ORM that replaces Granite
- **Native Asset Pipeline** - Built-in ESM support without Webpack or npm
- **Simplified Architecture** - Streamlined project structure and conventions
- **Modern Crystal Support** - Requires Crystal >= 1.10.0

## Installation

### Prerequisites

Make sure you have the following installed:
- [Homebrew](https://brew.sh/)
- Crystal (will be installed automatically as a dependency)

### Install via Tap

```bash
# Add the tap
brew tap crimson-knight/amber-v2 https://github.com/crimson-knight/amber-v2-homebrew.git

# Install Amber V2 CLI
brew install crimson-knight/amber-v2/amber-v2
```

### Alternative: Install HEAD (latest development version)

```bash
brew install --HEAD crimson-knight/amber-v2/amber-v2
```

### Conflicts with Original Amber

If you have the original `amber` formula installed, you must uninstall it first:

```bash
brew uninstall amber
```

The `amber-v2` formula conflicts with the original because both install an `amber` binary.

## Usage

After installation, you can use the `amber` command:

```bash
# Create a new Amber V2 application
amber new my_app

# Create with specific database
amber new my_app -d postgresql

# Create with specific template engine
amber new my_app -t ecr

# See all options
amber new --help
```

## Generated Application Dependencies

Applications generated by Amber V2 CLI include:

```yaml
dependencies:
  # Amber Framework V2
  amber:
    github: crimson-knight/amber
    branch: master

  # Grant ORM (ActiveRecord-style, replaces Granite in V2)
  grant:
    github: crimson-knight/grant
    branch: main

  # Asset Pipeline (native ESM, no Webpack/npm required)
  asset_pipeline:
    github: amberframework/asset_pipeline

  # File uploads (optional)
  gemma:
    github: amberframework/gemma

  # Database adapters
  pg:
    github: will/crystal-pg
  mysql:
    github: crystal-lang/crystal-mysql
  sqlite3:
    github: crystal-lang/crystal-sqlite3
```

## Testing Locally (Development)

If you want to test the CLI without installing via Homebrew:

1. Clone the amber_cli repository:
   ```bash
   git clone https://github.com/crimson-knight/amber_cli.git
   cd amber_cli
   ```

2. Build the CLI:
   ```bash
   shards install
   shards build
   ```

3. Use the local binary:
   ```bash
   ./bin/amber new my_test_app
   ```

Or add an alias to your shell configuration:
```bash
alias .amber-v2cli="/path/to/amber_cli/bin/amber"
```

## Updating

To update to the latest version:

```bash
brew update
brew upgrade amber-v2
```

Or for HEAD:
```bash
brew upgrade --fetch-HEAD amber-v2
```

## Uninstallation

```bash
brew uninstall amber-v2
brew untap crimson-knight/amber-v2
```

## Troubleshooting

### Build Failures

If you encounter build failures, ensure all dependencies are installed:

```bash
brew install crystal openssl@3 libyaml libpq mysql-client sqlite
```

### Database Connection Issues

Make sure the appropriate database client libraries are installed for your chosen database:
- PostgreSQL: `brew install libpq`
- MySQL: `brew install mysql-client`
- SQLite: `brew install sqlite`

## Documentation

For full documentation on Amber Framework V2, visit:
- [Amber Framework Website](https://amberframework.org)
- [V2 Documentation](https://amberframework.org/docs/v2)

## License

MIT License - See [LICENSE](LICENSE) for details.
